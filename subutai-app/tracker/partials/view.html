<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-md-9">
        <h2>Tracker</h2>
        <ol class="breadcrumb">
            <li>
                <a href="index.html">Home</a>
            </li>
            <li class="active">
                <strong>Tracker</strong>
            </li>
        </ol>
    </div>
</div>
<div class="panel-body trackerWrapper" ng-controller="TrackerCtrl as trackerCtrl">
    <div class="row">
        <div class="col-md-12 moduleFilters">
            <div class="ibox float-e-margins animated fadeInLeft">
                <div class="ibox-title">
                    <h5>Choose module <small>to see operations list</small></h5>
                    <div class="ibox-tools">
                        <a class="collapse-link">
                            <i class="fa fa-chevron-up"></i>
                        </a>
                        <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                            <i class="fa fa-wrench"></i>
                        </a>
                        <ul class="dropdown-menu dropdown-user">
                            <li><a href="#">Config option 1</a>
                            </li>
                            <li><a href="#">Config option 2</a>
                            </li>
                        </ul>
                        <a class="close-link">
                            <i class="fa fa-times"></i>
                        </a>
                    </div>
                </div>
                <div class="ibox-content">
                    <form action="" method="" name="">
                        <div class="col-md-4">
                            Source
                            <select class="form-control m-b"
                                    ng-change="trackerCtrl.loadOperations()"
                                    ng-model="trackerCtrl.modulesDropdown"
                                    ng-options="module.name for module in trackerCtrl.modules">
                            </select>
                        </div>
                        <div class="col-md-4">
                            From
                            <input type="date" ng-model="startDate" id="start" class="form-control m-b">
                        </div>
                        <div class="col-md-4">
                            To
                            <input type="date" ng-model="endDate" id="end" class="form-control m-b">
                        </div>
                    </form>
                </div>
            </div>

        </div>

        <div class="col-md-12">
            <div class="ibox float-e-margins animated fadeInRight">
                <div class="ibox-title">
                    <h5>Selected module operations <small>list</small></h5>
                    <div class="ibox-tools">
                        <a class="collapse-link">
                            <i class="fa fa-chevron-up"></i>
                        </a>
                        <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                            <i class="fa fa-wrench"></i>
                        </a>
                        <ul class="dropdown-menu dropdown-user">
                            <li><a href="#">Config option 1</a>
                            </li>
                            <li><a href="#">Config option 2</a>
                            </li>
                        </ul>
                        <a class="close-link">
                            <i class="fa fa-times"></i>
                        </a>
                    </div>
                </div>
                <div class="ibox-content">
                    <table id="operationsTable" datatable="" class="table table-striped table-bordered table-hover">
                        <thead>
                        <tr>
                            <th>Date</th>
                            <th>Operation</th>
                            <th>Status</th>
                            <th>Logs</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="operation in trackerCtrl.operations | dateRange: startDate : endDate" repeat-done="initDataTable">
                            <td>{{operation.date | toStringFilter}}</td>
                            <td>{{operation.name}}</td>
                            <td>{{operation.status}}</td>
                            <td><button class="btn btn-primary"
                                        ng-click="trackerCtrl.viewLogs()"
                                        data-toggle="modal"
                                        data-target="#logsModal">View logs</button></td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>
</div>

<div class="modal fade" id="logsModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Chosen module logs</h4>
            </div>
            <div class="modal-body">
                <div id="logsContainer" class="mCustomScrollbar" data-mcs-theme="dark"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal">OK</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<script type="text/javascript">
    (function($){
        $(window).load(function(){
            $("#logsContainer").mCustomScrollbar({
                axis:"y",
                theme:"dark",
                advanced:{autoExpandHorizontalScroll:true}
            });
        });
    })(jQuery);
</script>